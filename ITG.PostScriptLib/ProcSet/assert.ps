%!PS-Adobe-3.0
%%Creator: Sergey S. Betke <sergey.s.betke@yandex.ru>
%%Copyright: 2018 Sergey S. Betke <sergey.s.betke@yandex.ru>
%%+ See LICENSE at https://github.com/Metrolog/marks
%%DocumentData: Clean7Bit
%%DocumentSuppliedResources: ProcSet (assert)
%%Version: 2.2 0
%%EndComments
%%BeginProlog

%(assert) /ProcSet resourcestatus { pop pop } {
%!PS-Adobe-3.0 Resource-ProcSet
%%BeginResource: ProcSet (assert)
/assert <<

/assert % bool string --> -
{
  $error /newerror false put
  dup type  /booleantype  eq  { (untitled) } if
    exch not
    {
      (%stderr) (w) file
      dup (Assertion ') writestring
      dup  3 -1 roll  writestring
      (' failed!\n) writestring
      $error /newerror true put
      stop
    }
    {
      (Assertion ') print  print  (' passed.\n) print
    }
  ifelse
} bind

/almost_equal % a b --> bool
{
  1 index % a b a
  sub abs
  100 mul % a  |b-a|*100
  exch abs % |b-a|*100  |a|
  le
} bind

/sizes_almost_equal % sx1 sy1 sx2 sy2 --> bool
{
      3 -1 roll exch  % sx1 sx2 sy1 sy2
    almost_equal
    3 1 roll  almost_equal
  and
} bind

>> /ProcSet defineresource pop
%%EndResource:
%} ifelse

%%EndProlog
